<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Crop Recommendation System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  </head>
  <style>
      body {
        background: linear-gradient(rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.8)), url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8ZmFybXxlbnwwfHwwfHw%3D&w=1000&q=80');
        background-size: cover;
        background-attachment: fixed;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
      
      .crop-highlight {
        background-color: #28a745;
        color: white;
        padding: 2px 8px;
        border-radius: 4px;
        font-weight: bold;
      }
      
      h1 {
        color: #2e7d32;
        text-align: center;
        font-weight: 700;
        margin-bottom: 30px;
      }

      .warning {
        color: red;
        font-weight: bold;
        text-align: center;
      }
      
      .navbar {
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      
      .badge {
        font-size: 0.85rem;
        padding: 0.35em 0.65em;
      }
      
      .badge.bg-success {
        background-color: #28a745 !important;
      }
      
      .badge.bg-info {
        background-color: #17a2b8 !important;
        color: white;
      }
      
      .navbar-brand {
        font-weight: 700;
        font-size: 1.5rem;
      }
      
      .nav-link {
        font-weight: 500;
        transition: all 0.3s;
      }
      
      .nav-link:hover {
        transform: translateY(-2px);
      }
      
      .container-main {
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        margin-top: 30px;
        margin-bottom: 30px;
        font-weight: 500;
      }
      
      .form-label {
        font-weight: 600;
        color: #2e7d32;
      }
      
      .form-control:focus {
        border-color: #4caf50;
        box-shadow: 0 0 0 0.25rem rgba(76, 175, 80, 0.25);
      }
      
      .btn-primary {
        background-color: #2e7d32;
        border-color: #2e7d32;
        padding: 10px 30px;
        font-weight: 600;
        transition: all 0.3s;
      }
      
      .btn-primary:hover {
        background-color: #1b5e20;
        border-color: #1b5e20;
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
      }
      
      .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
        padding: 10px 30px;
        font-weight: 600;
        transition: all 0.3s;
      }
      
      .btn-secondary:hover {
        background-color: #5a6268;
        border-color: #5a6268;
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
      }
      
      .result-card {
        background: linear-gradient(135deg, #2e7d32, #1b5e20);
        border-radius: 15px;
        padding: 20px;
        color: white;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        margin: 30px auto;
        max-width: 800px;
        text-align: center;
      }
      
      .result-card img {
        border-radius: 10px;
        margin-bottom: 15px;
        max-height: 200px;
        width: 100%;
        object-fit: cover;
        border: 3px solid #e8f5e9;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      
      .input-group-text {
        background-color: #e8f5e9;
        color: #2e7d32;
        font-weight: 600;
        border-color: #c8e6c9;
      }
      
      .parameter-icon {
        color: #2e7d32;
        font-size: 1.2rem;
        margin-right: 5px;
      }
      
      footer {
        background: #343a40;
        color: white;
        padding: 20px 0;
      }
      
      .social-icons a {
        color: white;
        font-size: 1.5rem;
        margin-right: 15px;
        transition: all 0.3s;
      }
      
      .social-icons a:hover {
        color: #4caf50;
        transform: translateY(-3px);
      }
      
      .hero-section {
        text-align: center;
        padding: 20px 0;
        margin-bottom: 30px;
        border-radius: 10px;
        background: rgba(46, 125, 50, 0.1);
      }
      
      .hero-section p {
        font-size: 1.2rem;
        max-width: 800px;
        margin: 0 auto;
      }
      
      .parameter-card {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        margin-bottom: 20px;
        transition: all 0.3s;
        border-left: 4px solid #2e7d32;
      }
      
      .parameter-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }
      
      .search-history-section {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }
      
      .search-history-section h3 {
        color: #2e7d32;
        font-weight: 600;
      }
      
      .table-success {
        background-color: #e8f5e9;
      }
      
      .table-hover tbody tr:hover {
        background-color: #f1f8e9;
      }
      
      .btn-outline-success {
        color: #2e7d32;
        border-color: #2e7d32;
        transition: all 0.3s;
      }
      
      .btn-outline-success:hover {
        background-color: #2e7d32;
        color: white;
      }
  </style>

  <body>
    <!-- Header/Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-success">
      <div class="container">
        <a class="navbar-brand" href="/">
          <i class="fas fa-seedling me-2"></i>Crop Recommendation System
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/"><i class="fas fa-home me-1"></i> Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/about"><i class="fas fa-info-circle me-1"></i> About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/contact"><i class="fas fa-envelope me-1"></i> Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

<!--==========================================================================================-->
  <div class="container container-main my-5">
    <div class="hero-section mb-4">
      <h1><i class="fas fa-seedling me-2"></i>AI Based Crop Recommendation System<i class="fas fa-seedling ms-2"></i></h1>
      <p class="lead">Enter your soil parameters and environmental conditions to get personalized crop recommendations for optimal yield.</p>
    </div>
    
    <div class="row mb-4">
      <div class="col-md-6 mb-3">
        <div class="parameter-card">
          <h5 class="mb-3"><i class="fas fa-leaf parameter-icon"></i>Quick Value Selector</h5>
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="cropSelect" class="form-label">Select Crop</label>
              <select id="cropSelect" class="form-select">
                <option value="">-- Select a crop --</option>
                <option value="rice">Rice</option>
                <option value="maize">Maize</option>
                <option value="jute">Jute</option>
                <option value="cotton">Cotton</option>
                <option value="coconut">Coconut</option>
                <option value="papaya">Papaya</option>
                <option value="orange">Orange</option>
                <option value="apple">Apple</option>
                <option value="muskmelon">Muskmelon</option>
                <option value="watermelon">Watermelon</option>
                <option value="grapes">Grapes</option>
                <option value="mango">Mango</option>
                <option value="banana">Banana</option>
                <option value="pomegranate">Pomegranate</option>
                <option value="lentil">Lentil</option>
                <option value="blackgram">Blackgram</option>
                <option value="mungbean">Mungbean</option>
                <option value="mothbeans">Mothbeans</option>
                <option value="pigeonpeas">Pigeonpeas</option>
                <option value="kidneybeans">Kidneybeans</option>
                <option value="chickpea">Chickpea</option>
                <option value="coffee">Coffee</option>
              </select>
            </div>
            <div class="col-md-6 mb-3">
              <label for="seasonSelect" class="form-label">Select Season</label>
              <select id="seasonSelect" class="form-select">
                <option value="">-- Select a season --</option>
                <option value="summer">Summer</option>
                <option value="winter">Winter</option>
                <option value="monsoon">Monsoon</option>
                <option value="autumn">Autumn</option>
              </select>
            </div>
          </div>
          <button type="button" id="populateValues" class="btn btn-success w-100"><i class="fas fa-magic me-2"></i>Populate Approximate Values</button>
        </div>
      </div>
    </div>
    
    <form action="/predict" method="POST" class="mb-4">
      <div class="row mb-4">
        <div class="col-md-4 mb-3">
          <div class="parameter-card">
            <label for="Nitrogen" class="form-label"><i class="fas fa-flask parameter-icon"></i>Nitrogen (N)</label>
            <div class="input-group">
              <input type="number" id="Nitrogen" name="Nitrogen" placeholder="Enter value" class="form-control" required step="0">
              <span class="input-group-text">kg/ha</span>
            </div>
            <small class="text-muted">Essential for leaf growth</small>
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <div class="parameter-card">
            <label for="Phosporus" class="form-label"><i class="fas fa-atom parameter-icon"></i>Phosphorus (P)</label>
            <div class="input-group">
              <input type="number" id="Phosporus" name="Phosporus" placeholder="Enter value" class="form-control" required step="0">
              <span class="input-group-text">kg/ha</span>
            </div>
            <small class="text-muted">Important for root development</small>
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <div class="parameter-card">
            <label for="Potassium" class="form-label"><i class="fas fa-microscope parameter-icon"></i>Potassium (K)</label>
            <div class="input-group">
              <input type="number" id="Potassium" name="Potassium" placeholder="Enter value" class="form-control" required step="0">
              <span class="input-group-text">kg/ha</span>
            </div>
            <small class="text-muted">Helps in overall plant health</small>
          </div>
        </div>
      </div>

      <div class="row mb-4">
        <div class="col-md-4 mb-3">
          <div class="parameter-card">
            <label for="Temperature" class="form-label"><i class="fas fa-temperature-high parameter-icon"></i>Temperature</label>
            <div class="input-group">
              <input type="number" step="0.01" id="Temperature" name="Temperature" placeholder="Enter value" class="form-control" required>
              <span class="input-group-text">°C</span>
            </div>
            <small class="text-muted">Average temperature of the region</small>
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <div class="parameter-card">
            <label for="Humidity" class="form-label"><i class="fas fa-tint parameter-icon"></i>Humidity</label>
            <div class="input-group">
              <input type="number" step="0.01" id="Humidity" name="Humidity" placeholder="Enter value" class="form-control" required>
              <span class="input-group-text">%</span>
            </div>
            <small class="text-muted">Relative humidity of the atmosphere</small>
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <div class="parameter-card">
            <label for="Ph" class="form-label"><i class="fas fa-vial parameter-icon"></i>pH Level</label>
            <div class="input-group">
              <input type="number" step="0.01" id="Ph" name="Ph" placeholder="Enter value" class="form-control" required>
              <span class="input-group-text">pH</span>
            </div>
            <small class="text-muted">pH value of the soil (0-14)</small>
          </div>
        </div>
      </div>

      <div class="row mb-4">
        <div class="col-md-4 mb-3">
          <div class="parameter-card">
            <label for="Rainfall" class="form-label"><i class="fas fa-cloud-rain parameter-icon"></i>Rainfall</label>
            <div class="input-group">
              <input type="number" step="0.01" id="Rainfall" name="Rainfall" placeholder="Enter value" class="form-control" required>
              <span class="input-group-text">mm</span>
            </div>
            <small class="text-muted">Annual rainfall in the region</small>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12 text-center">
          <button type="submit" class="btn btn-primary btn-lg me-2"><i class="fas fa-search me-2"></i>Get Crop Recommendation</button>
          <a href="/reset" onclick="document.getElementById('resetForm').submit(); return false;" class="btn btn-secondary btn-lg"><i class="fas fa-undo me-2"></i>Reset Form</a>
        </div>
      </div>
    </form>
    
    <!-- Hidden form for reset action -->
    <form id="resetForm" action="/reset" method="POST" style="display:none;"></form>

    {% if result %}
    <div id="resultCard" class="result-card">
      <div class="row">
        <div class="col-md-4">
          {% if crop_name %}
          <img src="/static/{{ crop_name }}.jpg" class="img-fluid rounded" alt="{{ crop_name|capitalize }} Image" onerror="this.onerror=null; this.src='/static/muskmelon.jpg';">
          {% else %}
          <img src="/static/muskmelon.jpg" class="img-fluid rounded" alt="Crop Image">
          {% endif %}
        </div>
        <div class="col-md-8 d-flex align-items-center">
          <div>
            <h3 class="mb-3">Recommended Crop</h3>
            <p class="fs-4 mb-2">{% if crop_name %}{{ result|replace(crop_name|capitalize, '<span class="crop-highlight">' + crop_name|capitalize + '</span>')|safe }}{% else %}{{ result }}{% endif %}</p>
            <p class="mb-0"><i class="fas fa-check-circle me-2"></i>Based on your soil parameters and environmental conditions</p>
            
            <div class="mt-3">
              <div class="row">
                <div class="col-md-6">
                  <p class="mb-1"><i class="fas fa-flask text-primary"></i> <strong>Nitrogen:</strong> <span id="recommended-crop-n"></span> kg/ha</p>
                  <p class="mb-1"><i class="fas fa-flask text-success"></i> <strong>Phosphorus:</strong> <span id="recommended-crop-p"></span> kg/ha</p>
                  <p class="mb-1"><i class="fas fa-flask text-warning"></i> <strong>Potassium:</strong> <span id="recommended-crop-k"></span> kg/ha</p>
                  <p class="mb-1"><i class="fas fa-thermometer-half text-danger"></i> <strong>Temp:</strong> <span id="recommended-crop-temp"></span> °C</p>
                </div>
                <div class="col-md-6">
                  <p class="mb-1"><i class="fas fa-tint text-info"></i> <strong>Humidity:</strong> <span id="recommended-crop-humidity"></span> %</p>
                  <p class="mb-1"><i class="fas fa-vial text-secondary"></i> <strong>pH:</strong> <span id="recommended-crop-ph"></span></p>
                  <p class="mb-1"><i class="fas fa-cloud-rain text-primary"></i> <strong>Rainfall:</strong> <span id="recommended-crop-rainfall"></span> mm</p>
                  <p class="mb-1"><i class="fas fa-calendar-alt text-success"></i> <strong>Season:</strong> <span id="recommended-crop-season"></span></p>
                </div>
              </div>
            </div>
            
            {% if current_inputs %}
            <button class="btn btn-light mt-3" type="button" data-bs-toggle="collapse" data-bs-target="#detailedInputs" aria-expanded="false" aria-controls="detailedInputs">
              <i class="fas fa-info-circle me-2"></i>View Detailed Inputs
            </button>
            <div class="collapse mt-3" id="detailedInputs">
              <div class="card card-body text-dark">
                <h5 class="text-success">Your Input Parameters</h5>
                <div class="row">
                  <div class="col-md-6">
                    <p><strong>Nitrogen:</strong> {{ current_inputs.Nitrogen }} kg/ha</p>
                    <p><strong>Phosphorus:</strong> {{ current_inputs.Phosphorus }} kg/ha</p>
                    <p><strong>Potassium:</strong> {{ current_inputs.Potassium }} kg/ha</p>
                    <p><strong>Temperature:</strong> {{ current_inputs.Temperature }} °C</p>
                  </div>
                  <div class="col-md-6">
                    <p><strong>Humidity:</strong> {{ current_inputs.Humidity }} %</p>
                    <p><strong>pH Level:</strong> {{ current_inputs.pH }}</p>
                    <p><strong>Rainfall:</strong> {{ current_inputs.Rainfall }} mm</p>
                  </div>
                </div>
              </div>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    
    <!-- Similar Season Crops Section -->
    {% if result and similar_season_crops and similar_season_crops|length > 0 %}
    <div class="container container-main my-4">
      <h3 class="text-center mb-4"><i class="fas fa-seedling me-2"></i>Other Crops for Same Season</h3>
      <div class="row mt-3">
        {% for crop in similar_season_crops %}
        <div class="col-md-6 mb-4">
          <div class="card crop-card h-100 shadow-sm">
            <div class="row g-0">
              <div class="col-md-4">
                <img src="/static/{{ crop|lower }}.jpg" class="img-fluid rounded-start h-100" alt="{{ crop }} Image" onerror="this.onerror=null; this.src='/static/muskmelon.jpg';" style="object-fit: cover;">
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <h5 class="card-title">{{ crop }}</h5>
                  <div class="small">
                    <div class="row">
                      <div class="col-6">
                        <p class="mb-1"><i class="fas fa-flask text-primary"></i> <strong>Nitrogen:</strong> <span id="{{ crop|lower }}-n"></span> kg/ha</p>
                        <p class="mb-1"><i class="fas fa-flask text-success"></i> <strong>Phosphorus:</strong> <span id="{{ crop|lower }}-p"></span> kg/ha</p>
                        <p class="mb-1"><i class="fas fa-flask text-warning"></i> <strong>Potassium:</strong> <span id="{{ crop|lower }}-k"></span> kg/ha</p>
                        <p class="mb-1"><i class="fas fa-thermometer-half text-danger"></i> <strong>Temp:</strong> <span id="{{ crop|lower }}-temp"></span> °C</p>
                      </div>
                      <div class="col-6">
                        <p class="mb-1"><i class="fas fa-tint text-info"></i> <strong>Humidity:</strong> <span id="{{ crop|lower }}-humidity"></span> %</p>
                        <p class="mb-1"><i class="fas fa-vial text-secondary"></i> <strong>pH:</strong> <span id="{{ crop|lower }}-ph"></span></p>
                        <p class="mb-1"><i class="fas fa-cloud-rain text-primary"></i> <strong>Rainfall:</strong> <span id="{{ crop|lower }}-rainfall"></span> mm</p>
                        <p class="mb-1"><i class="fas fa-calendar-alt text-success"></i> <strong>Season:</strong> <span id="{{ crop|lower }}-season"></span></p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
    
    <!-- Search History Section -->
    {% if search_history and search_history|length > 0 %}
    <div class="search-history-section mt-5">
      <h3 class="text-center mb-4"><i class="fas fa-history me-2"></i>Recent Search History</h3>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead class="table-success">
            <tr>
              <th>Date & Time</th>
              <th>Recommended Crop</th>
              <th>Season</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for search in search_history %}
            <tr>
              <td>{{ search.timestamp }}</td>
              <td>{% if search.crop_name %}{{ search.result|replace(search.crop_name|capitalize, '<span class="crop-highlight">' + search.crop_name|capitalize + '</span>')|safe }}{% else %}{{ search.result }}{% endif %}</td>
              <td>
                {% if search.suitable_seasons %}
                  {% if 'all' in search.suitable_seasons %}
                    <span class="badge bg-info">All Seasons</span>
                  {% else %}
                    {% for season in search.suitable_seasons %}
                      <span class="badge bg-info me-1">{{ season|capitalize }}</span>
                    {% endfor %}
                  {% endif %}
                {% else %}
                  <span>-</span>
                {% endif %}
              </td>
              <td>
                <button class="btn btn-sm btn-outline-success" type="button" data-bs-toggle="collapse" 
                        data-bs-target="#history{{ loop.index }}" aria-expanded="false">
                  <i class="fas fa-eye me-1"></i>View Details
                </button>
              </td>
            </tr>
            <tr>
              <td colspan="3" class="p-0">
                <div class="collapse" id="history{{ loop.index }}">
                  <div class="card card-body m-2">
                    <div class="row">
                      <div class="col-md-3">
                        {% if search.crop_name %}
                        <img src="/static/{{ search.crop_name }}.jpg" class="img-fluid rounded mb-3" alt="{{ search.crop_name|capitalize }} Image" onerror="this.onerror=null; this.src='/static/muskmelon.jpg';">
                        {% else %}
                        <img src="/static/muskmelon.jpg" class="img-fluid rounded mb-3" alt="Crop Image">
                        {% endif %}
                      </div>
                      <div class="col-md-9">
                        <div class="row">
                          <div class="col-md-6">
                            <p><strong>Nitrogen:</strong> {{ search.inputs.Nitrogen }} kg/ha</p>
                            <p><strong>Phosphorus:</strong> {{ search.inputs.Phosphorus }} kg/ha</p>
                            <p><strong>Potassium:</strong> {{ search.inputs.Potassium }} kg/ha</p>
                            <p><strong>Temperature:</strong> {{ search.inputs.Temperature }} °C</p>
                          </div>
                          <div class="col-md-6">
                            <p><strong>Humidity:</strong> {{ search.inputs.Humidity }} %</p>
                            <p><strong>pH Level:</strong> {{ search.inputs.pH }}</p>
                            <p><strong>Rainfall:</strong> {{ search.inputs.Rainfall }} mm</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}
  </div>

  <!-- Footer -->
  <footer class="bg-success text-white">
    <div class="container py-4">
      <div class="row">
        <div class="col-md-6">
          <h5><i class="fas fa-seedling me-2"></i>Crop Recommendation System</h5>
          <p>Empowering farmers with AI-driven crop recommendations for sustainable agriculture.</p>
        </div>
        <div class="col-md-3">
          <h5>Quick Links</h5>
          <ul class="list-unstyled">
            <li><a href="/" class="text-white">Home</a></li>
            <li><a href="/about" class="text-white">About</a></li>
            <li><a href="/contact" class="text-white">Contact</a></li>
          </ul>
        </div>
        <div class="col-md-3">
          <h5>Connect With Us</h5>
          <div class="social-icons">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
          </div>
        </div>
      </div>
      <hr class="my-4 bg-light">
      <div class="row">
        <div class="col-md-12 text-center">
          <p class="mb-0">© 2023 Crop Recommendation System. All rights reserved.</p>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
  
  <script>
    // Auto-scroll to result card when it exists
    document.addEventListener('DOMContentLoaded', function() {
      const resultCard = document.getElementById('resultCard');
      if (resultCard) {
        // Scroll to the result card with a smooth animation after a short delay
        setTimeout(function() {
          resultCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 300);
        
        // Populate recommended crop values
        const cropName = '{{ crop_name|lower }}';
        console.log('Crop name:', cropName); // Debug log
        
        // Set default values first
        document.getElementById('recommended-crop-n').textContent = '80';
        document.getElementById('recommended-crop-p').textContent = '40';
        document.getElementById('recommended-crop-k').textContent = '40';
        document.getElementById('recommended-crop-temp').textContent = '25';
        document.getElementById('recommended-crop-humidity').textContent = '80';
        document.getElementById('recommended-crop-ph').textContent = '6.5';
        document.getElementById('recommended-crop-rainfall').textContent = '200';
        document.getElementById('recommended-crop-season').textContent = '{{ current_season|capitalize }}';
        
        // Try to get actual values if available
        if (cropName && cropValues[cropName]) {
          console.log('Found crop in cropValues:', cropName); // Debug log
          const season = '{{ current_season|lower }}';
          const crop = cropValues[cropName];
          
          // Set values for the recommended crop
          document.getElementById('recommended-crop-n').textContent = crop.N;
          document.getElementById('recommended-crop-p').textContent = crop.P;
          document.getElementById('recommended-crop-k').textContent = crop.K;
          
          // Set temperature based on season if available
          if (crop.temp && season && crop.temp[season]) {
            document.getElementById('recommended-crop-temp').textContent = crop.temp[season];
          } else if (crop.temp) {
            // Use an average or the first available season
            const firstSeason = Object.keys(crop.temp)[0];
            document.getElementById('recommended-crop-temp').textContent = crop.temp[firstSeason];
          }
          
          // Set humidity based on season if available
          if (crop.humidity && season && crop.humidity[season]) {
            document.getElementById('recommended-crop-humidity').textContent = crop.humidity[season];
          } else if (crop.humidity) {
            // Use an average or the first available season
            const firstSeason = Object.keys(crop.humidity)[0];
            document.getElementById('recommended-crop-humidity').textContent = crop.humidity[firstSeason];
          }
          
          document.getElementById('recommended-crop-ph').textContent = crop.ph;
          
          // Set rainfall based on season if available
          if (crop.rainfall && season && crop.rainfall[season]) {
            document.getElementById('recommended-crop-rainfall').textContent = crop.rainfall[season];
          } else if (crop.rainfall) {
            // Use an average or the first available season
            const firstSeason = Object.keys(crop.rainfall)[0];
            document.getElementById('recommended-crop-rainfall').textContent = crop.rainfall[firstSeason];
          }
        } else {
          console.log('Crop not found in cropValues:', cropName); // Debug log
        }
      }
      
      // Populate similar crops values
      {% if similar_season_crops %}
      const similarCrops = {{ similar_season_crops|tojson }};
      const currentSeason = '{{ current_season|lower }}';
      console.log('Similar crops:', similarCrops); // Debug log
      console.log('Current season:', currentSeason); // Debug log
      
      // Populate values for each similar crop
      similarCrops.forEach(crop => {
        const cropLower = crop.toLowerCase();
        console.log('Processing similar crop:', cropLower); // Debug log
        
        // Set default values first
        try {
          document.getElementById(`${cropLower}-n`).textContent = '80';
          document.getElementById(`${cropLower}-p`).textContent = '40';
          document.getElementById(`${cropLower}-k`).textContent = '40';
          document.getElementById(`${cropLower}-temp`).textContent = '25';
          document.getElementById(`${cropLower}-humidity`).textContent = '80';
          document.getElementById(`${cropLower}-ph`).textContent = '6.5';
          document.getElementById(`${cropLower}-rainfall`).textContent = '200';
          document.getElementById(`${cropLower}-season`).textContent = '{{ current_season|capitalize }}';
        } catch (e) {
          console.error('Error setting default values for', cropLower, e);
        }
        
        // Try to get actual values if available
        if (cropValues[cropLower]) {
          console.log('Found similar crop in cropValues:', cropLower); // Debug log
          const cropData = cropValues[cropLower];
          
          try {
            // Set basic values
            document.getElementById(`${cropLower}-n`).textContent = cropData.N;
            document.getElementById(`${cropLower}-p`).textContent = cropData.P;
            document.getElementById(`${cropLower}-k`).textContent = cropData.K;
            
            // Set temperature based on season
            if (cropData.temp && currentSeason && cropData.temp[currentSeason]) {
              document.getElementById(`${cropLower}-temp`).textContent = cropData.temp[currentSeason];
            } else if (cropData.temp) {
              const firstSeason = Object.keys(cropData.temp)[0];
              document.getElementById(`${cropLower}-temp`).textContent = cropData.temp[firstSeason];
            }
            
            // Set humidity based on season
            if (cropData.humidity && currentSeason && cropData.humidity[currentSeason]) {
              document.getElementById(`${cropLower}-humidity`).textContent = cropData.humidity[currentSeason];
            } else if (cropData.humidity) {
              const firstSeason = Object.keys(cropData.humidity)[0];
              document.getElementById(`${cropLower}-humidity`).textContent = cropData.humidity[firstSeason];
            }
            
            // Set pH
            document.getElementById(`${cropLower}-ph`).textContent = cropData.ph;
            
            // Set rainfall based on season
            if (cropData.rainfall && currentSeason && cropData.rainfall[currentSeason]) {
              document.getElementById(`${cropLower}-rainfall`).textContent = cropData.rainfall[currentSeason];
            } else if (cropData.rainfall) {
              const firstSeason = Object.keys(cropData.rainfall)[0];
              document.getElementById(`${cropLower}-rainfall`).textContent = cropData.rainfall[firstSeason];
            }
          } catch (e) {
            console.error('Error setting values for', cropLower, e);
          }
        } else {
          console.log('Similar crop not found in cropValues:', cropLower); // Debug log
        }
      });
      {% endif %}
      
      // Crop and Season selector functionality
      const cropSelect = document.getElementById('cropSelect');
      const seasonSelect = document.getElementById('seasonSelect');
      const populateButton = document.getElementById('populateValues');
      
      // Define approximate values for each crop
      const cropValues = {
        rice: {
          N: 80,
          P: 40,
          K: 40,
          temp: {
            summer: 24,
            winter: 20,
            monsoon: 23,
            autumn: 22
          },
          humidity: {
            summer: 80,
            winter: 70,
            monsoon: 83,
            autumn: 75
          },
          ph: 6.5,
          rainfall: {
            summer: 200,
            winter: 150,
            monsoon: 250,
            autumn: 180
          }
        },
        maize: {
          N: 80,
          P: 50,
          K: 20,
          temp: {
            summer: 25,
            winter: 18,
            monsoon: 22,
            autumn: 20
          },
          humidity: {
            summer: 65,
            winter: 55,
            monsoon: 70,
            autumn: 60
          },
          ph: 6.0,
          rainfall: {
            summer: 80,
            winter: 60,
            monsoon: 100,
            autumn: 70
          }
        },
        jute: {
          N: 80,
          P: 40,
          K: 40,
          temp: {
            summer: 28,
            winter: 22,
            monsoon: 25,
            autumn: 24
          },
          humidity: {
            summer: 85,
            winter: 75,
            monsoon: 90,
            autumn: 80
          },
          ph: 7.0,
          rainfall: {
            summer: 180,
            winter: 120,
            monsoon: 200,
            autumn: 150
          }
        },
        cotton: {
          N: 120,
          P: 40,
          K: 20,
          temp: {
            summer: 30,
            winter: 22,
            monsoon: 26,
            autumn: 25
          },
          humidity: {
            summer: 60,
            winter: 50,
            monsoon: 70,
            autumn: 55
          },
          ph: 6.5,
          rainfall: {
            summer: 80,
            winter: 60,
            monsoon: 100,
            autumn: 70
          }
        },
        coconut: {
          N: 90,
          P: 45,
          K: 60,
          temp: {
            summer: 30,
            winter: 25,
            monsoon: 27,
            autumn: 26
          },
          humidity: {
            summer: 90,
            winter: 80,
            monsoon: 95,
            autumn: 85
          },
          ph: 6.0,
          rainfall: {
            summer: 200,
            winter: 150,
            monsoon: 250,
            autumn: 180
          }
        },
        papaya: {
          N: 100,
          P: 50,
          K: 50,
          temp: {
            summer: 28,
            winter: 22,
            monsoon: 25,
            autumn: 24
          },
          humidity: {
            summer: 70,
            winter: 60,
            monsoon: 80,
            autumn: 65
          },
          ph: 6.0,
          rainfall: {
            summer: 150,
            winter: 100,
            monsoon: 200,
            autumn: 120
          }
        },
        orange: {
          N: 120,
          P: 40,
          K: 50,
          temp: {
            summer: 26,
            winter: 20,
            monsoon: 23,
            autumn: 22
          },
          humidity: {
            summer: 60,
            winter: 50,
            monsoon: 70,
            autumn: 55
          },
          ph: 6.0,
          rainfall: {
            summer: 100,
            winter: 80,
            monsoon: 120,
            autumn: 90
          }
        },
        apple: {
          N: 100,
          P: 60,
          K: 80,
          temp: {
            summer: 22,
            winter: 15,
            monsoon: 20,
            autumn: 18
          },
          humidity: {
            summer: 65,
            winter: 55,
            monsoon: 75,
            autumn: 60
          },
          ph: 6.5,
          rainfall: {
            summer: 100,
            winter: 80,
            monsoon: 120,
            autumn: 90
          }
        },
        muskmelon: {
          N: 90,
          P: 50,
          K: 50,
          temp: {
            summer: 30,
            winter: 22,
            monsoon: 26,
            autumn: 24
          },
          humidity: {
            summer: 60,
            winter: 50,
            monsoon: 70,
            autumn: 55
          },
          ph: 6.5,
          rainfall: {
            summer: 80,
            winter: 60,
            monsoon: 100,
            autumn: 70
          }
        },
        watermelon: {
          N: 100,
          P: 50,
          K: 40,
          temp: {
            summer: 32,
            winter: 24,
            monsoon: 28,
            autumn: 26
          },
          humidity: {
            summer: 65,
            winter: 55,
            monsoon: 75,
            autumn: 60
          },
          ph: 6.0,
          rainfall: {
            summer: 90,
            winter: 70,
            monsoon: 110,
            autumn: 80
          }
        },
        grapes: {
          N: 110,
          P: 60,
          K: 70,
          temp: {
            summer: 28,
            winter: 20,
            monsoon: 24,
            autumn: 22
          },
          humidity: {
            summer: 60,
            winter: 50,
            monsoon: 70,
            autumn: 55
          },
          ph: 6.0,
          rainfall: {
            summer: 80,
            winter: 60,
            monsoon: 100,
            autumn: 70
          }
        },
        mango: {
          N: 100,
          P: 50,
          K: 50,
          temp: {
            summer: 30,
            winter: 24,
            monsoon: 27,
            autumn: 26
          },
          humidity: {
            summer: 70,
            winter: 60,
            monsoon: 80,
            autumn: 65
          },
          ph: 5.5,
          rainfall: {
            summer: 150,
            winter: 100,
            monsoon: 200,
            autumn: 120
          }
        },
        banana: {
          N: 100,
          P: 75,
          K: 50,
          temp: {
            summer: 30,
            winter: 25,
            monsoon: 28,
            autumn: 27
          },
          humidity: {
            summer: 80,
            winter: 70,
            monsoon: 85,
            autumn: 75
          },
          ph: 6.5,
          rainfall: {
            summer: 200,
            winter: 150,
            monsoon: 250,
            autumn: 180
          }
        },
        pomegranate: {
          N: 90,
          P: 40,
          K: 40,
          temp: {
            summer: 30,
            winter: 22,
            monsoon: 26,
            autumn: 24
          },
          humidity: {
            summer: 45,
            winter: 40,
            monsoon: 55,
            autumn: 45
          },
          ph: 7.0,
          rainfall: {
            summer: 50,
            winter: 40,
            monsoon: 60,
            autumn: 45
          }
        },
        lentil: {
          N: 60,
          P: 80,
          K: 40,
          temp: {
            summer: 25,
            winter: 18,
            monsoon: 22,
            autumn: 20
          },
          humidity: {
            summer: 60,
            winter: 50,
            monsoon: 70,
            autumn: 55
          },
          ph: 6.5,
          rainfall: {
            summer: 60,
            winter: 50,
            monsoon: 80,
            autumn: 60
          }
        },
        blackgram: {
          N: 60,
          P: 60,
          K: 40,
          temp: {
            summer: 30,
            winter: 22,
            monsoon: 26,
            autumn: 24
          },
          humidity: {
            summer: 70,
            winter: 60,
            monsoon: 80,
            autumn: 65
          },
          ph: 7.0,
          rainfall: {
            summer: 80,
            winter: 60,
            monsoon: 100,
            autumn: 70
          }
        },
        chickpea: {
          N: 60,
          P: 70,
          K: 40,
          temp: {
            summer: 24,
            winter: 18,
            monsoon: 22,
            autumn: 20
          },
          humidity: {
            summer: 60,
            winter: 50,
            monsoon: 70,
            autumn: 55
          },
          ph: 7.0,
          rainfall: {
            summer: 60,
            winter: 50,
            monsoon: 80,
            autumn: 60
          }
        },
        coffee: {
          N: 100,
          P: 20,
          K: 30,
          temp: {
            summer: 26,
            winter: 20,
            monsoon: 23,
            autumn: 22
          },
          humidity: {
            summer: 80,
            winter: 70,
            monsoon: 85,
            autumn: 75
          },
          ph: 6.0,
          rainfall: {
            summer: 150,
            winter: 100,
            monsoon: 200,
            autumn: 120
          }
        },
        // Default values for other crops
        default: {
          N: 80,
          P: 40,
          K: 40,
          temp: {
            summer: 25,
            winter: 20,
            monsoon: 23,
            autumn: 22
          },
          humidity: {
            summer: 70,
            winter: 60,
            monsoon: 80,
            autumn: 65
          },
          ph: 6.5,
          rainfall: {
            summer: 100,
            winter: 80,
            monsoon: 150,
            autumn: 90
          }
        }
      };
      
      // Function to populate form fields with values
      populateButton.addEventListener('click', function() {
        const selectedCrop = cropSelect.value;
        const selectedSeason = seasonSelect.value;
        
        if (!selectedCrop || !selectedSeason) {
          alert('Please select both a crop and a season');
          return;
        }
        
        // Get values for the selected crop (or use default if not specifically defined)
        const cropData = cropValues[selectedCrop] || cropValues.default;
        
        // Populate form fields
        document.getElementById('Nitrogen').value = cropData.N;
        document.getElementById('Phosporus').value = cropData.P;
        document.getElementById('Potassium').value = cropData.K;
        document.getElementById('Temperature').value = cropData.temp[selectedSeason];
        document.getElementById('Humidity').value = cropData.humidity[selectedSeason];
        document.getElementById('Ph').value = cropData.ph;
        document.getElementById('Rainfall').value = cropData.rainfall[selectedSeason];
      });
    });
  </script>
  </body>
</html>